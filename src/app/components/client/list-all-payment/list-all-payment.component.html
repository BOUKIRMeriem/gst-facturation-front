<p-toast></p-toast>
<div class="container-fluid">
  <div class="row">
    <div class="col-sm-12">
      <div class="card tab2-card">
        <div class="card-body">
          <div class="p-d-flex p-ai-center p-jc-between">
                                                <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" style="width: 160%;"
                                   (input)="dt2.filterGlobal($event.target.value, 'contains')" placeholder="Search..." />
                        </span>
          </div><br />
          <div class="clearfix"></div>
          <div class="card">
              <p-table #dt2 [value]="listPayments"  selectionMode="multiple"
                       [metaKeySelection]="true" styleClass="p-datatable-sm" [rows]="40" [paginator]="true" [scrollable]="true" scrollHeight="700px"
                       [globalFilterFields]="['id','factureClient.numPiece','date','client.name','client.ice','designation','amount']"
                       responsiveLayout="scroll" [rowHover]="true" dataKey="id" [resizableColumns]="true" [autoLayout]="true">
              <ng-template pTemplate="header">
                <tr style="font-size: 14px;">
                  <th *ngFor="let col of atrPayment" pSortableColumn="{{col.field}}"
                      [style.width]="col.width" [style.text-align]="col.position">
                    {{col.header}}
                  </th>
                  <th style="width: 2%"></th>
                  <th style="width: 6%">Action</th>
                </tr>

              </ng-template>
              <ng-template pTemplate="body" let-mat>
                <tr style="height: 2rem;font-size: 14px;" [pSelectableRow]="mat">
                  <td style="width: 2%" *ngIf="mat.verified">v</td>
                  <td style="width: 2%" *ngIf="!mat.verified">0</td>
                  <td style="width: 6%">{{mat.factureClient?.numPiece}}/{{mat.factureClient?.year}}</td>
                  <td style="width: 5%">{{mat.date | date: 'dd/MM/yyyy'}}</td>
                  <td style="width: 15%">{{mat.client?.name}}</td>
                  <td style="width: 12%">{{mat.client?.ice}}</td>
                  <td style="width: 15%">{{mat.designation}}</td>
                  <td style="width: 4%">{{getTypeName(mat.type)}}</td>
                  <td style="width: 8%">{{mat.deadline | date: 'dd/MM/yyyy'}}</td>
                  <td style="text-align:right;width: 7%">{{mat.amount | number : '1.2-2' | removeComma}}</td>
                  <td style="width: 2%"></td>
                  <td style="width: 6%">
                    <a href="javascript:;" *ngIf="!mat.verified" (click)="onClickVerifiedPayment(mat)"
                       title="Valider" class="text text-success"><i
                      class="fa fa-check"></i>&nbsp;|&nbsp;</a>
                    <a  href="javascript:;" *ngIf="mat.verified" (click)="onClickUnVerifiedPayment(mat)"
                        title="Devalider" class="text text-primary"><i
                      class="fa fa-check-square-o"></i>&nbsp;|&nbsp;</a>
                    <a  (click)="setPaymentToDelete(mat)" (click)="open(deleteModal)" title="Supprimer" href="javascript:;" class="text text-danger"><i
                      class="fa fa-trash"></i></a>
                  </td>
                </tr>
              </ng-template>
            </p-table>
            <ng-template #deleteModal let-modal>
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title f-w-600" id="myModal_delete_produit">Supprimer
                  </h5>
                </div>
                <div class="modal-body">
                  <div class="container" style="padding: 20px 20px;">
                    <div style="text-align: center;margin-bottom: 15px;  ">
                      <i class="fa fa-exclamation-triangle fa-5x"
                         style="text-align: center; color: red;" aria-hidden="true"></i>
                    </div>
                  </div>
                  <div style="margin-bottom: 20px;">
                    <h4 style="text-align: center;">
                      Êtes-vous sûr?
                    </h4>
                  </div>
                  <div style="text-align: center; color: whitesmoke; margin-bottom: 20px;">
                    <p style="line-height:15px;">
                      Voulez-vous vraiment supprimer cet enregistrement ? Ce processus ne peut pas
                      être annulé.</p>
                  </div>

                </div>
                <div class="modal-footer" style="text-align: center;">

                  <button type="button" class="btn btn-primary" href="javascript:;"
                          (click)="onClickDeletePayment()" (click)="modal.dismiss('Cross click')">
                    Supprimer
                  </button>
                  &nbsp;
                  <button type="button" class="btn btn-secondary"
                          (click)="modal.dismiss('Cross click')" href="javascript:;" data-dismiss="modal">

                    Annuler
                  </button>


                </div>
              </div>

            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
